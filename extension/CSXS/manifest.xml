<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<ExtensionManifest xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" 
                   ExtensionBundleId="com.example.mathformula.bundle" 
                   ExtensionBundleVersion="1.0.0" 
                   Version="7.0">
  <ExtensionList>
    <Extension Id="com.example.mathformula.panel" Version="1.0.0"/>
  </ExtensionList>

  <ExecutionEnvironment>
    <HostList>
      <!-- 使用版本范围以支持多个版本 -->
      <Host Name="ILST" Version="[17.0,99.9]"/>
    </HostList>

    <LocaleList>
      <Locale Code="All"/>
    </LocaleList>

    <RequiredRuntimeList>
      <!-- 使用版本范围以支持多个CSXS版本 -->
      <RequiredRuntime Name="CSXS" Version="[6.0,99.9]"/>
    </RequiredRuntimeList>
  </ExecutionEnvironment>
  
  <DispatchInfoList>
    <Extension Id="com.example.mathformula.panel">
      <DispatchInfo>
        <ExtensionData>
          <Version>1.0.0</Version>
        </ExtensionData>
        
        <Resources>
          <MainPath>./client/index.html</MainPath>
          <!-- CEF命令行参数 - 重要！ -->
          <CEFCommandLine>
            <Parameter>--enable-devtools</Parameter>
            <Parameter>--allow-file-access-from-files</Parameter>
          </CEFCommandLine>
          <!-- ExtendScript路径 -->
          <ScriptPath>./host/illustrator.jsx</ScriptPath>
        </Resources>

        <Lifecycle>
          <AutoVisible>true</AutoVisible>
        </Lifecycle>

        <UI>
          <Type>Panel</Type>
          <Menu>数学公式生成器</Menu>
          <Geometry>
            <Size>
              <Height>600</Height>
              <Width>400</Width>
            </Size>
            <MaxSize>
              <Height>800</Height>
              <Width>600</Width>
            </MaxSize>
            <MinSize>
              <Height>400</Height>
              <Width>300</Width>
            </MinSize>
          </Geometry>
        </UI>
      </DispatchInfo>
    </Extension>
  </DispatchInfoList>
</ExtensionManifest>
